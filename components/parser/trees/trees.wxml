<wxs module="cssHandler" src="./cssHandler.wxs" />
<block wx:for='{{nodes}}' wx:key>
    <!-- button 类型 -->
    <block wx:if="{{item.name == 'button'}}">
        <button type="default" size="mini">
            <trees class="{{item.name||item.type}} {{item.attrs.class}}" style="{{item.attrs.style}}" nodes="{{item.children}}" controls="{{controls}}" />
        </button>
    </block>
    <!-- a类型 -->
    <block wx:elif="{{item.name == 'a'}}">
        <navigator url="{{item.attrs.href}}" style="{{item.attrs.style}}" data-href='{{item.attrs.href}}' hover-class="navigator-hover" bindtap="tapEvent">
            <trees id="node" nodes="{{item.children}}" controls="{{controls}}" />
        </navigator>
    </block>
    <!-- video类型 -->
    <block wx:elif="{{item.name == 'video'}}">
        <view wx:if="{{item.attrs.id>'video3'&&!controls[item.attrs.id].play}}" 
            class="video" 
            style="{{item.attrs.style+(item.attrs.width?(';width:'+item.attrs.width):'')+(item.attrs.height?('height:'+item.attrs.height):'')}}" 
            data-id="{{item.attrs.id}}" 
            bindtap="_loadVideo">
            <view class="video-triangle" />
        </view>
        <video wx:else 
            src='{{controls[item.attrs.id]?item.attrs.source[controls[item.attrs.id].index]:item.attrs.src}}' 
            id="{{item.attrs.id}}" 
            loop='{{item.attrs.loop}}' 
            controls='{{item.attrs.controls}}' 
            autoplay="{{item.attrs.autoplay||controls[item.attrs.id].play}}" 
            class="v"
            style="{{item.attrs.style+(item.attrs.width?(';width:'+item.attrs.width):'')+(item.attrs.height?('height:'+item.attrs.height):'')}}" 
            data-id="{{item.attrs.id}}" data-source="{{item.attrs.source}}" 
            bindplay='playEvent' 
            binderror="errorEvent" 
        />
    </block>
    <!-- audio类型 -->
    <block wx:elif="{{item.name == 'audio'}}">
        <audio 
            src='{{controls[item.attrs.id]?item.attrs.source[controls[item.attrs.id].index]:item.attrs.src}}' 
            id="{{item.attrs.id}}" 
            class="{{item.name||item.type}}"
            loop='{{item.attrs.loop}}' 
            controls='{{item.attrs.controls}}' 
            poster='{{item.attrs.poster}}' 
            name='{{item.attrs.name}}' 
            author='{{item.attrs.author}}' 
            style="{{item.attrs.style}}" 
            data-id="{{item.attrs.id}}" 
            data-source="{{item.attrs.source}}" 
            binderror="errorEvent" 
        />
    </block>
    <!-- img类型 -->
    <block wx:elif="{{item.name == 'img'}}">
        <image 
            class="{{item.attrs.class}} {{item.name||item.type}}" 
            style="{{cssHandler.setImgStyle(item.attrs.style,imageWidth,imageHeight)}}"
            src="{{item.attrs.src}}"
            data-ignore='{{item.attrs.ignore}}'
            data-src='{{item.attrs.src}}'
            bindload="_loadImg"
            bindtap='previewEvent' 
            mode="widthFix" 
        />
    </block>
    <!-- 纯文本类型 -->
    <block wx:elif="{{item.type == 'text'}}">
        <text decode>{{cssHandler.setText(item.text)}}</text>
    </block>
    <block wx:elif="{{item.name == 'br'}}">
        <text>\n</text>
    </block>
    <!-- 其他类型 -->
    <block wx:else>
        <trees class="{{item.name||item.type}} {{item.attrs.class}}" style="{{item.attrs.style}}" nodes="{{item.children}}" controls="{{controls}}" />
    </block>
    <block wx:if="{{!item.continue}}">
        <!-- 图片 -->
        <!-- <rich-text wx:if="{{item.name=='img'}}" style="{{cssHandler.getStyle(item.attrs.style,'inline-block')}}" nodes='{{cssHandler.setImgStyle(item,controls.imgMode)}}' data-ignore='{{item.attrs.ignore}}' data-src='{{item.attrs.src}}' bindtap='previewEvent' /> -->
        <!-- 文本 -->
        <!-- <text wx:elif="{{item.type=='text'&&!item.decode}}" decode>{{item.text}}</text> -->
        <!-- <text wx:elif="{{item.name=='br'}}">\n</text> -->
        <!-- 视频 -->
        <!-- <block wx:elif="{{item.name=='video'}}">
            <view wx:if="{{item.attrs.id>'video3'&&!controls[item.attrs.id].play}}" class="video" style="{{item.attrs.style+(item.attrs.width?(';width:'+item.attrs.width):'')+(item.attrs.height?('height:'+item.attrs.height):'')}}" data-id="{{item.attrs.id}}" bindtap="_loadVideo">
                <view class="video-triangle" />
            </view>
            <video wx:else src='{{controls[item.attrs.id]?item.attrs.source[controls[item.attrs.id].index]:item.attrs.src}}' id="{{item.attrs.id}}" loop='{{item.attrs.loop}}' controls='{{item.attrs.controls}}' autoplay="{{item.attrs.autoplay||controls[item.attrs.id].play}}" class="v" muted="{{item.attrs.muted}}" style="{{item.attrs.style+(item.attrs.width?(';width:'+item.attrs.width):'')+(item.attrs.height?('height:'+item.attrs.height):'')}}" data-id="{{item.attrs.id}}" data-source="{{item.attrs.source}}" bindplay='playEvent' binderror="errorEvent" />
        </block> -->
        <!-- 音频 -->
        <!-- <audio wx:elif="{{item.name=='audio'}}" src='{{controls[item.attrs.id]?item.attrs.source[controls[item.attrs.id].index]:item.attrs.src}}' id="{{item.attrs.id}}" loop='{{item.attrs.loop}}' controls='{{item.attrs.controls}}' poster='{{item.attrs.poster}}' name='{{item.attrs.name}}' author='{{item.attrs.author}}' style="{{item.attrs.style}}" data-id="{{item.attrs.id}}" data-source="{{item.attrs.source}}" binderror="errorEvent" /> -->
        <!-- 富文本 -->
        <!-- <rich-text wx:else class="{{item.name||item.type}} {{item.attrs.class}}" style="{{cssHandler.getStyle(item.attrs.style,'block')}}" nodes="{{cssHandler.setStyle(item)}}" /> -->
    </block>
    <!-- 链接 -->
    <!-- <navigator wx:elif="{{item.name=='a'}}" url="{{item.attrs.href}}" style="{{item.attrs.style}}" data-href='{{item.attrs.href}}' hover-class="navigator-hover" bindtap="tapEvent">
        <trees id="node" nodes="{{item.children}}" controls="{{controls}}" />
    </navigator> -->
    <!-- 继续递归 -->
    <!-- <trees wx:else id="node" class="{{item.name}}" style="{{item.attrs.style}}" nodes="{{item.children}}" controls="{{controls}}" /> -->
</block>